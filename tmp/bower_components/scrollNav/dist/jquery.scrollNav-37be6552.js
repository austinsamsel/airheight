/*! scrollNav - v2.6.0 - 2015-02-19
* http://scrollnav.com
* Copyright (c) 2015 James Wilson; Licensed MIT */
!function(s){var t=function(t,e,n,i){if(s(t).length>0){var a=s(t).offset().top;e=i?e:0,s("html:not(:animated),body:not(:animated)").animate({scrollTop:a-n},e)}},e=function(){return window.location.hash},n={classes:{loading:"sn-loading",failed:"sn-failed",success:"sn-active"},defaults:{sections:"h2",subSections:!1,sectionElem:"section",className:"scroll-nav",showHeadline:!0,headlineText:"Scroll To",showTopLink:!0,topLinkText:"Top",fixedMargin:40,scrollOffset:40,animated:!0,speed:500,insertLocation:"insertBefore",arrowKeys:!1,scrollToHash:!0,onInit:null,onRender:null,onDestroy:null,onResetPos:null},_set_body_class:function(t){var e=s("body");"loading"===t?e.addClass(n.classes.loading):"success"===t?e.removeClass(n.classes.loading).addClass(n.classes.success):e.removeClass(n.classes.loading).addClass(n.classes.failed)},_find_sections:function(t){var e=n.settings.sections,i=[];if(n.settings.showTopLink){var a=t.children().first();a.is(e)||i.push(a.nextUntil(e).andSelf())}t.find(e).each(function(){i.push(s(this).nextUntil(e).andSelf())}),n.sections={raw:i}},_setup_sections:function(t){var e=[];s(t).each(function(t){var i=[],a=s(this),o="scrollNav-"+(t+1),l=function(){return 0===t},c=function(){return!a.eq(0).is(n.settings.sections)},r=n.settings.showTopLink&&l()&&c()?n.settings.topLinkText:a.filter(n.settings.sections).text();if(a.wrapAll("<"+n.settings.sectionElem+' id="'+o+'" class="'+n.settings.className+'__section" />'),n.settings.subSections){var d=a.filter(n.settings.subSections);d.length>0&&d.each(function(t){var e=o+"-"+(t+1),l=s(this).text(),c=a.filter(s(this).nextUntil(d).andSelf());c.wrapAll('<div id="'+e+'" class="'+n.settings.className+'__sub-section" />'),i.push({id:e,text:l})})}e.push({id:o,text:r,sub_sections:i})}),n.sections.data=e},_tear_down_sections:function(t){s(t).each(function(){var t=this.sub_sections;s("#"+this.id).children().unwrap(),t.length>0&&s(t).each(function(){s("#"+this.id).children().unwrap()})})},_setup_nav:function(t){var e=s("<span />",{"class":n.settings.className+"__heading",text:n.settings.headlineText}),i=s("<div />",{"class":n.settings.className+"__wrapper"}),a=s("<nav />",{"class":n.settings.className,role:"navigation"}),o=s("<ol />",{"class":n.settings.className+"__list"});s.each(t,function(t){var e,i=0===t?s("<li />",{"class":n.settings.className+"__item active"}):s("<li />",{"class":n.settings.className+"__item"}),a=s("<a />",{href:"#"+this.id,"class":n.settings.className+"__link",text:this.text});this.sub_sections.length>0&&(i.addClass("is-parent-item"),e=s("<ol />",{"class":n.settings.className+"__sub-list"}),s.each(this.sub_sections,function(){var t=s("<li />",{"class":n.settings.className+"__sub-item"}),i=s("<a />",{href:"#"+this.id,"class":n.settings.className+"__sub-link",text:this.text});e.append(t.append(i))})),o.append(i.append(a).append(e))}),n.settings.showHeadline?a.append(i.append(e).append(o)):a.append(i.append(o)),n.nav=a},_insert_nav:function(){var s=n.settings.insertLocation,t=n.settings.insertTarget;n.nav[s](t)},_setup_pos:function(){var t=n.nav,e=s(window).height(),i=t.offset().top,a=function(t){var e=s("#"+t.id),n=e.height();t.top_offset=e.offset().top,t.bottom_offset=t.top_offset+n};s.each(n.sections.data,function(){a(this),s.each(this.sub_sections,function(){a(this)})}),n.dims={vp_height:e,nav_offset:i}},_check_pos:function(){var t=n.nav,e=s(window).scrollTop(),i=e+n.settings.scrollOffset,a=e+n.dims.vp_height-n.settings.scrollOffset,o=[],l=[];e>n.dims.nav_offset-n.settings.fixedMargin?t.addClass("fixed"):t.removeClass("fixed");var c=function(s){return s.top_offset>=i&&s.top_offset<=a||s.bottom_offset>i&&s.bottom_offset<a||s.top_offset<i&&s.bottom_offset>a};s.each(n.sections.data,function(){c(this)&&o.push(this),s.each(this.sub_sections,function(){c(this)&&l.push(this)})}),t.find("."+n.settings.className+"__item").removeClass("active").removeClass("in-view"),t.find("."+n.settings.className+"__sub-item").removeClass("active").removeClass("in-view"),s.each(o,function(s){0===s?t.find('a[href="#'+this.id+'"]').parents("."+n.settings.className+"__item").addClass("active").addClass("in-view"):t.find('a[href="#'+this.id+'"]').parents("."+n.settings.className+"__item").addClass("in-view")}),n.sections.active=o,s.each(l,function(s){0===s?t.find('a[href="#'+this.id+'"]').parents("."+n.settings.className+"__sub-item").addClass("active").addClass("in-view"):t.find('a[href="#'+this.id+'"]').parents("."+n.settings.className+"__sub-item").addClass("in-view")})},_init_scroll_listener:function(){s(window).on("scroll.scrollNav",function(){n._check_pos()})},_rm_scroll_listeners:function(){s(window).off("scroll.scrollNav")},_init_resize_listener:function(){s(window).on("resize.scrollNav",function(){n._setup_pos(),n._check_pos()})},_rm_resize_listener:function(){s(window).off("resize.scrollNav")},_init_click_listener:function(){s("."+n.settings.className).find("a").on("click.scrollNav",function(e){e.preventDefault();var i=s(this).attr("href"),a=n.settings.speed,o=n.settings.scrollOffset,l=n.settings.animated;t(i,a,o,l)})},_rm_click_listener:function(){s("."+n.settings.className).find("a").off("click.scrollNav")},_init_keyboard_listener:function(e){n.settings.arrowKeys&&s(document).on("keydown.scrollNav",function(s){if(40===s.keyCode||38===s.keyCode){var i=function(s){var t=0,i=e.length;for(t;i>t;t++)if(e[t].id===n.sections.active[0].id){var a=40===s?t+1:t-1,o=void 0===e[a]?void 0:e[a].id;return o}},a=i(s.keyCode);if(void 0!==a){s.preventDefault();var o="#"+a,l=n.settings.speed,c=n.settings.scrollOffset,r=n.settings.animated;t(o,l,c,r)}}})},_rm_keyboard_listener:function(){s(document).off("keydown.scrollNav")},init:function(i){return this.each(function(){var a=s(this);n.settings=s.extend({},n.defaults,i),n.settings.insertTarget=n.settings.insertTarget?s(n.settings.insertTarget):a,a.length>0?(n.settings.onInit&&n.settings.onInit.call(this),n._set_body_class("loading"),n._find_sections(a),a.find(n.settings.sections).length>0?(n._setup_sections(n.sections.raw),n._setup_nav(n.sections.data),n.settings.insertTarget.length>0?(n._insert_nav(),n._setup_pos(),n._check_pos(),n._init_scroll_listener(),n._init_resize_listener(),n._init_click_listener(),n._init_keyboard_listener(n.sections.data),n._set_body_class("success"),n.settings.scrollToHash&&t(e()),n.settings.onRender&&n.settings.onRender.call(this)):(console.log('Build failed, scrollNav could not find "'+n.settings.insertTarget+'"'),n._set_body_class("failed"))):(console.log('Build failed, scrollNav could not find any "'+n.settings.sections+'s" inside of "'+a.selector+'"'),n._set_body_class("failed"))):(console.log('Build failed, scrollNav could not find "'+a.selector+'"'),n._set_body_class("failed"))})},destroy:function(){return this.each(function(){n._rm_scroll_listeners(),n._rm_resize_listener(),n._rm_click_listener(),n._rm_keyboard_listener(),s("body").removeClass("sn-loading sn-active sn-failed"),s("."+n.settings.className).remove(),n._tear_down_sections(n.sections.data),n.settings.onDestroy&&n.settings.onDestroy.call(this),n.settings=[],n.sections=void 0})},resetPos:function(){n._setup_pos(),n._check_pos(),n.settings.onResetPos&&n.settings.onResetPos.call(this)}};s.fn.scrollNav=function(){var t,e=arguments[0];if(n[e])e=n[e],t=Array.prototype.slice.call(arguments,1);else{if("object"!=typeof e&&e)return s.error("Method "+e+" does not exist in the scrollNav plugin"),this;e=n.init,t=arguments}return e.apply(this,t)}}(jQuery);