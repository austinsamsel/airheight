module("callbacks",{teardown:moduleTeardown}),function(){function a(a){if("string"==typeof a)return"'"+a+"'";var t,i=[];for(t in a)i.push("'"+t+"': "+a[t]);return"{ "+i.join(", ")+" }"}var t,i=function(a){return function(){t+=a}},e=i("A"),n=i("B"),c=i("C"),r={"":"XABC   X     XABCABCC  X  XBB X   XABA  X   XX",once:"XABC   X     X         X  X   X   XABA  X   XX",memory:"XABC   XABC  XABCABCCC XA XBB XB  XABA  XC  XX",unique:"XABC   X     XABCA     X  XBB X   XAB   X   X",stopOnFalse:"XABC   X     XABCABCC  X  XBB X   XA    X   XX","once memory":"XABC   XABC  X         XA X   XA  XABA  XC  XX","once unique":"XABC   X     X         X  X   X   XAB   X   X","once stopOnFalse":"XABC   X     X         X  X   X   XA    X   XX","memory unique":"XABC   XA    XABCA     XA XBB XB  XAB   XC  X","memory stopOnFalse":"XABC   XABC  XABCABCCC XA XBB XB  XA    X   XX","unique stopOnFalse":"XABC   X     XABCA     X  XBB X   XA    X   X"},l={"no filter":void 0,filter:function(a){return function(){return a.apply(this,arguments)}}};jQuery.each(r,function(i,r){var s={};jQuery.each(i.split(" "),function(){this.length&&(s[this]=!0)}),jQuery.each(l,function(l){jQuery.each({string:i,object:s},function(i,s){test("jQuery.Callbacks( "+a(s)+" ) - "+l,function(){function a(){t+="X"}expect(21),stop(),setTimeout(start,0);var i,l=r.split(/\s+/);t="X",i=jQuery.Callbacks(s),i.add(function(a){t+=a}),i.fire("A"),strictEqual(t,"XA","Basic binding and firing"),strictEqual(i.fired(),!0,".fired() detects firing"),t="X",i.disable(),i.add(function(a){t+=a}),strictEqual(t,"X","Adding a callback after disabling"),i.fire("A"),strictEqual(t,"X","Firing after disabling"),i=jQuery.Callbacks(s),i.add(i.empty),i.add(function(){ok(!1,"not emptied")}),i.fire(),i=jQuery.Callbacks(s),i.add(i.disable),i.add(function(){ok(!1,"not disabled")}),i.fire(),t="X",i=jQuery.Callbacks(s),i.add(function(){equal(this,window,"Basic binding and firing (context)"),t+=Array.prototype.join.call(arguments,"")}),i.fireWith(window,["A","B"]),strictEqual(t,"XAB","Basic binding and firing (arguments)"),t="",i=jQuery.Callbacks(s),i.add(function(){equal(this,window,"fireWith with no arguments (context is window)"),strictEqual(arguments.length,0,"fireWith with no arguments (no arguments)")}),i.fireWith(),t="X",i=jQuery.Callbacks(s),i.add(e,n,c),i.remove(n,c),i.fire(),strictEqual(t,"XA","Basic binding, removing and firing"),t="X",i=jQuery.Callbacks(s),i.add(e),i.add(n),i.add(c),i.empty(),i.fire(),strictEqual(t,"X","Empty"),t="X",i=jQuery.Callbacks(s),i.add(function(a){t+=a}),i.lock(),i.add(function(a){t+=a}),i.fire("A"),i.add(function(a){t+=a}),strictEqual(t,"X","Lock early"),t="X",i=jQuery.Callbacks(s),i.add(function(){i.add(c),e()},n),i.fire(),strictEqual(t,l.shift(),"Proper ordering"),t="X",i.add(function(){i.add(c),e()},n),strictEqual(t,l.shift(),"Add after fire"),t="X",i.fire(),strictEqual(t,l.shift(),"Fire again"),t="X",i=jQuery.Callbacks(s),i.add(function(a){t+=a}),i.fire("A"),strictEqual(t,"XA","Multiple fire (first fire)"),t="X",i.add(function(a){t+=a}),strictEqual(t,l.shift(),"Multiple fire (first new callback)"),t="X",i.fire("B"),strictEqual(t,l.shift(),"Multiple fire (second fire)"),t="X",i.add(function(a){t+=a}),strictEqual(t,l.shift(),"Multiple fire (second new callback)"),t="X",i=jQuery.Callbacks(s),i.add(e,function(){return!1},n),i.add(e),i.fire(),strictEqual(t,l.shift(),"Callback returning false"),t="X",i.add(c),strictEqual(t,l.shift(),"Adding a callback after one returned false"),t="",a.method=function(){t+="!"},i=jQuery.Callbacks(s),i.add(a),i.add(a),i.fire(),strictEqual(t,l.shift(),"No callback iteration")})})})})}(),test("jQuery.Callbacks( options ) - options are copied",function(){expect(1);var a={unique:!0},t=jQuery.Callbacks(a),i=0,e=function(){ok(!i++,"called once")};a.unique=!1,t.add(e,e),t.fire()}),test("jQuery.Callbacks.fireWith - arguments are copied",function(){expect(1);var a=jQuery.Callbacks("memory"),t=["hello"];a.fireWith(null,t),t[0]="world",a.add(function(a){strictEqual(a,"hello","arguments are copied internally")})}),test("jQuery.Callbacks.remove - should remove all instances",function(){function a(){ok(!1,"function wasn't removed")}expect(1);var t=jQuery.Callbacks();t.add(a,a,function(){ok(!0,"end of test")}).remove(a).fire()}),test("jQuery.Callbacks.has",function(){function a(){return"A"}function t(){return"B"}function i(){return"C"}expect(13);var e=jQuery.Callbacks();e.add(a,t,i),strictEqual(e.has(),!0,"No arguments to .has() returns whether callback function(s) are attached or not"),strictEqual(e.has(a),!0,"Check if a specific callback function is in the Callbacks list"),e.remove(t),strictEqual(e.has(t),!1,"Remove a specific callback function and make sure its no longer there"),strictEqual(e.has(a),!0,"Remove a specific callback function and make sure other callback function is still there"),e.empty(),strictEqual(e.has(),!1,"Empty list and make sure there are no callback function(s)"),strictEqual(e.has(a),!1,"Check for a specific function in an empty() list"),e.add(a,t,function(){strictEqual(e.has(),!0,"Check if list has callback function(s) from within a callback function"),strictEqual(e.has(a),!0,"Check if list has a specific callback from within a callback function")}).fire(),strictEqual(e.has(),!0,"Callbacks list has callback function(s) after firing"),e.disable(),strictEqual(e.has(),!1,"disabled() list has no callback functions (returns false)"),strictEqual(e.has(a),!1,"Check for a specific function in a disabled() list"),e=jQuery.Callbacks("unique"),e.add(a),e.add(a),strictEqual(e.has(),!0,"Check if unique list has callback function(s) attached"),e.lock(),strictEqual(e.has(),!1,"locked() list is empty and returns false")}),test("jQuery.Callbacks() - adding a string doesn't cause a stack overflow",function(){expect(1),jQuery.Callbacks().add("hello world"),ok(!0,"no stack overflow")});