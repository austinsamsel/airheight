jQuery.extend({Deferred:function(e){var r=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",t={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(r,function(r,t){var o=t[0],u=e[r];i[t[1]](jQuery.isFunction(u)?function(){var e=u.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===i?n:this,[e])}:n[o])}),e=null}).promise()},promise:function(e){return null!=e?jQuery.extend(e,t):t}},i={};return t.pipe=t.then,jQuery.each(r,function(e,o){var u=o[2],s=o[3];t[o[1]]=u.add,s&&u.add(function(){n=s},r[1^e][2].disable,r[2][2].lock),i[o[0]]=u.fire,i[o[0]+"With"]=u.fireWith}),t.promise(i),e&&e.call(i,i),i},when:function(e){var r,n,t,i=0,o=core_slice.call(arguments),u=o.length,s=1!==u||e&&jQuery.isFunction(e.promise)?u:0,a=1===s?e:jQuery.Deferred(),c=function(e,n,t){return function(i){n[e]=this,t[e]=arguments.length>1?core_slice.call(arguments):i,t===r?a.notifyWith(n,t):--s||a.resolveWith(n,t)}};if(u>1)for(r=new Array(u),n=new Array(u),t=new Array(u);u>i;i++)o[i]&&jQuery.isFunction(o[i].promise)?o[i].promise().done(c(i,t,o)).fail(a.reject).progress(c(i,n,r)):--s;return s||a.resolveWith(t,o),a.promise()}});