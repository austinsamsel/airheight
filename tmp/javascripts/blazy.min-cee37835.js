/*!
  hey, [be]Lazy.js - v1.3.1 - 2015.02.01
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Blazy=t()}(this,function(){function e(e){if(!document.querySelectorAll){var i=document.createStyleSheet();document.querySelectorAll=function(e,t,n,r,s){for(s=document.all,t=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(","),n=e.length;n--;){for(i.addRule(e[n],"k:v"),r=s.length;r--;)s[r].currentStyle.k&&t.push(s[r]);i.removeRule(0)}return t}}g=!0,f=[],h={},d=e||{},d.error=d.error||!1,d.offset=d.offset||100,d.success=d.success||!1,d.selector=d.selector||".b-lazy",d.separator=d.separator||"|",d.container=d.container?document.querySelectorAll(d.container):!1,d.errorClass=d.errorClass||"b-error",d.breakpoints=d.breakpoints||!1,d.successClass=d.successClass||"b-loaded",d.src=c=d.src||"data-src",m=1<window.devicePixelRatio,h.top=0-d.offset,h.left=0-d.offset,y=u(n,25),v=u(s,50),s(),l(d.breakpoints,function(e){return e.width>=window.screen.width?(c=e.src,!1):void 0}),t()}function t(){r(d.selector),g&&(g=!1,d.container&&l(d.container,function(e){o(e,"scroll",y)}),o(window,"resize",v),o(window,"resize",y),o(window,"scroll",y)),n()}function n(){for(var t=0;p>t;t++){var n=f[t],i=n.getBoundingClientRect();(i.right>=h.left&&i.bottom>=h.top&&i.left<=h.right&&i.top<=h.bottom||-1!==(" "+n.className+" ").indexOf(" "+d.successClass+" "))&&(e.prototype.load(n),f.splice(t,1),p--,t--)}0===p&&e.prototype.destroy()}function i(e,t){if(t||0<e.offsetWidth&&0<e.offsetHeight){var n=e.getAttribute(c)||e.getAttribute(d.src);if(n){var n=n.split(d.separator),i=n[m&&1<n.length?1:0],n=new Image;l(d.breakpoints,function(t){e.removeAttribute(t.src)}),e.removeAttribute(d.src),n.onerror=function(){d.error&&d.error(e,"invalid"),e.className=e.className+" "+d.errorClass},n.onload=function(){"img"===e.nodeName.toLowerCase()?e.src=i:e.style.backgroundImage='url("'+i+'")',e.className=e.className+" "+d.successClass,d.success&&d.success(e)},n.src=i}else d.error&&d.error(e,"missing"),e.className=e.className+" "+d.errorClass}}function r(e){e=document.querySelectorAll(e);for(var t=p=e.length;t--;f.unshift(e[t]));}function s(){h.bottom=(window.innerHeight||document.documentElement.clientHeight)+d.offset,h.right=(window.innerWidth||document.documentElement.clientWidth)+d.offset}function o(e,t,n){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)}function a(e,t,n){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)}function l(e,t){if(e&&t)for(var n=e.length,i=0;n>i&&!1!==t(e[i],i);i++);}function u(e,t){var n=0;return function(){var i=+new Date;t>i-n||(n=i,e.apply(f,arguments))}}var c,d,h,f,p,m,g,y,v;return e.prototype.revalidate=function(){t()},e.prototype.load=function(e,t){-1===(" "+e.className+" ").indexOf(" "+d.successClass+" ")&&i(e,t)},e.prototype.destroy=function(){d.container&&l(d.container,function(e){a(e,"scroll",y)}),a(window,"scroll",y),a(window,"resize",y),a(window,"resize",v),p=0,f.length=0,g=!0},e});